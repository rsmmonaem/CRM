import{g as n,o as s,b as e,t as a,i as u,m as h,u as z,a as w,d,h as T,w as _,c as C,F as j,p as U,e as F,k as D,n as M,s as $,l as L,f as V,q}from"./app-BYl7acvR.js";import{_ as I}from"./ModernLayout-DqA9ysza.js";import{_ as P}from"./CallModal-DnvoMD1H.js";import{_ as R}from"./EditCallModal-QtCicpH3.js";import"./ApplicationLogo-BnyZX-wr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"fixed inset-0 z-50 overflow-y-auto"},G={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},J={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full"},K={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Q={class:"sm:flex sm:items-start"},W={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},X={class:"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100"},Y={class:"mt-2"},Z={class:"text-sm text-gray-500 dark:text-gray-400"},ee={class:"mt-6"},te={key:0,class:"space-y-6"},le={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},ae={class:"text-lg text-gray-700 dark:text-gray-300"},se={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},re={class:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},oe={key:0,class:"bg-blue-50 dark:bg-blue-900 rounded-lg p-4"},de={class:"text-lg text-blue-700 dark:text-blue-300"},ne={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},ie={class:"text-gray-700 dark:text-gray-300"},me={class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},ue={class:"text-gray-700 dark:text-gray-300"},ce={key:1,class:"text-center py-8"},ge={class:"mt-6 sm:flex sm:flex-row-reverse"},xe={__name:"ViewCallModal",props:{callDetail:Object,lead:Object},emits:["close"],setup(l,{emit:g}){const v=g,x=c=>c?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",b=c=>c?new Date(c).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not set";return(c,r)=>(s(),n("div",H,[e("div",G,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:r[0]||(r[0]=f=>v("close"))}),e("div",J,[e("div",K,[e("div",Q,[r[2]||(r[2]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-green-600 dark:text-green-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})])],-1)),e("div",W,[e("h3",X," Call Details: "+a(l.lead?.name),1),e("div",Y,[e("p",Z,a(l.lead?.company_name)+" • "+a(l.lead?.phone)+" • "+a(l.lead?.email),1)])])]),e("div",ee,[l.callDetail?(s(),n("div",te,[e("div",le,[r[3]||(r[3]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2"},"Call Date",-1)),e("p",ae,a(x(l.callDetail.call_followup_date)),1)]),e("div",se,[r[4]||(r[4]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2"},"Call Summary",-1)),e("p",re,a(l.callDetail.call_followup_summary),1)]),l.callDetail.next_call_date?(s(),n("div",oe,[r[5]||(r[5]=e("h4",{class:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2"},"Next Call Scheduled",-1)),e("p",de,a(x(l.callDetail.next_call_date)),1)])):u("",!0),e("div",ne,[r[6]||(r[6]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2"},"Recorded By",-1)),e("p",ie,a(l.callDetail.creator?.name||"Unknown"),1)]),e("div",me,[r[7]||(r[7]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2"},"Recorded On",-1)),e("p",ue,a(b(l.callDetail.created_at)),1)])])):(s(),n("div",ce,[...r[8]||(r[8]=[e("p",{class:"text-gray-500 dark:text-gray-400"},"No call details available.",-1)])]))]),e("div",ge,[e("button",{type:"button",onClick:r[1]||(r[1]=f=>v("close")),class:"w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-700 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:w-auto sm:text-sm"}," Close ")])])])])]))}},ye={class:"flex justify-between items-center"},be={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-100"},fe={class:"flex space-x-2"},ke={class:"py-6"},he={class:"max-w-9xl mx-auto px-4 sm:px-6 lg:px-8"},ve={class:"bg-white dark:bg-gray-800 shadow-sm sm:rounded-lg mb-6"},we={class:"p-6"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pe={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Ce={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},De={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},$e={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Se={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},je={class:"mt-1 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},Me={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Le={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Ve={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},Ne={class:"bg-white dark:bg-gray-800 shadow-sm sm:rounded-lg"},Ae={class:"p-6"},Be={key:0,class:"text-center py-8"},Ee={key:1,class:"space-y-4"},Oe={class:"flex justify-between items-start"},ze={class:"flex-1"},Te={class:"flex items-center space-x-4"},Ue={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},Fe={class:"text-sm text-gray-500 dark:text-gray-400"},qe={class:"text-sm text-gray-600 dark:text-gray-400 mt-2"},Ie={key:0,class:"mt-2"},Pe={class:"text-sm text-blue-600 dark:text-blue-400"},Re={class:"flex space-x-2"},He=["onClick"],Ge=["onClick"],Je=["onClick"],Ke={key:3,class:"fixed inset-0 z-50 overflow-y-auto"},Qe={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},We={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Xe={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Ye={class:"sm:flex sm:items-start"},Ze={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},et={class:"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100"},tt={class:"mt-2"},lt={class:"text-sm text-gray-500 dark:text-gray-400"},at={class:"space-y-4"},st={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-md"},rt={class:"text-sm text-red-800"},ot={key:0,class:"mt-1 text-sm text-red-600"},dt={key:0,class:"mt-1 text-sm text-red-600"},nt={key:0,class:"mt-1 text-sm text-red-600"},it={class:"mt-6 sm:flex sm:flex-row-reverse"},mt=["disabled"],ft={__name:"Show",props:{lead:Object,user:Object},setup(l){const g=l,v=(i,t)=>g.user?.is_admin?!0:g.user?.permissions?.[i]?.includes(t)||!1,x=i=>g.user?.is_admin||v("leads","create")?!0:i.assigned_user_id===g.user?.id,b=h(!1),c=h(!1),r=h(!1),f=h(!1),k=h(null),N=i=>{b.value=!0},S=()=>{c.value=!0},y=()=>{b.value=!1,c.value=!1,r.value=!1,f.value=!1,k.value=null},A=i=>{k.value=i,r.value=!0},B=i=>{k.value=i,f.value=!0},o=z({lead_id:g.lead.id,call_followup_date:new Date().toISOString().split("T")[0],call_followup_summary:"",next_call_date:""}),E=()=>{o.post(route("lead-details.store"),{onSuccess:()=>{y(),o.reset(),o.lead_id=g.lead.id,o.call_followup_date=new Date().toISOString().split("T")[0]},onError:i=>{console.error("Call submission errors:",i)}})},O=i=>{confirm(`Are you sure you want to delete this call record from ${new Date(i.call_followup_date).toLocaleDateString()}?`)&&q.delete(route("lead-details.destroy",i.id),{onSuccess:()=>{},onError:t=>{console.error("Delete call detail errors:",t)}})};return(i,t)=>(s(),n(j,null,[w(d(T),{title:`Lead: ${l.lead.name}`},null,8,["title"]),w(I,null,{header:_(()=>[e("div",ye,[e("h2",be," Lead Details: "+a(l.lead.name),1),e("div",fe,[x(l.lead)?(s(),n("button",{key:0,onClick:S,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Add Call ")):u("",!0),w(d(L),{href:i.route("leads.edit",l.lead.id),class:"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"},{default:_(()=>[...t[4]||(t[4]=[V(" Edit Lead ",-1)])]),_:1},8,["href"]),w(d(L),{href:i.route("leads.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:_(()=>[...t[5]||(t[5]=[V(" Back to Leads ",-1)])]),_:1},8,["href"])])])]),default:_(()=>[e("div",ke,[e("div",he,[e("div",ve,[t[15]||(t[15]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Lead Information")],-1)),e("div",we,[e("div",_e,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),e("p",pe,a(l.lead.name),1)]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Company",-1)),e("p",Ce,a(l.lead.company_name||"-"),1)]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Phone",-1)),e("p",De,a(l.lead.phone),1)]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email",-1)),e("p",$e,a(l.lead.email),1)]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Service",-1)),e("p",Se,a(l.lead.service.name),1)]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Status",-1)),e("span",je,a(l.lead.status.name),1)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Assigned To",-1)),e("p",Me,a(l.lead.assigned_user.name),1)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Created By",-1)),e("p",Le,a(l.lead.creator.name),1)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Created At",-1)),e("p",Ve,a(new Date(l.lead.created_at).toLocaleString()),1)])])])]),e("div",Ne,[t[17]||(t[17]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Call History")],-1)),e("div",Ae,[l.lead.lead_details.length===0?(s(),n("div",Be,[t[16]||(t[16]=e("p",{class:"text-gray-500 dark:text-gray-400"},"No call history found.",-1)),x(l.lead)?(s(),n("button",{key:0,onClick:S,class:"mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Add First Call ")):u("",!0)])):(s(),n("div",Ee,[(s(!0),n(j,null,U(l.lead.lead_details,m=>(s(),n("div",{key:m.id,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-gray-50 dark:bg-gray-900"},[e("div",Oe,[e("div",ze,[e("div",Te,[e("h4",Ue," Call on "+a(new Date(m.call_followup_date).toLocaleDateString()),1),e("span",Fe," by "+a(m.creator.name),1)]),e("p",qe,a(m.call_followup_summary),1),m.next_call_date?(s(),n("div",Ie,[e("p",Pe," Next call scheduled: "+a(new Date(m.next_call_date).toLocaleDateString()),1)])):u("",!0)]),e("div",Re,[e("button",{onClick:p=>B(m),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-3 rounded text-xs"}," 👁️ View ",8,He),x(l.lead)?(s(),n("button",{key:0,onClick:p=>A(m),class:"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-3 rounded text-xs"}," ✏️ Edit ",8,Ge)):u("",!0),x(l.lead)?(s(),n("button",{key:1,onClick:t[0]||(t[0]=p=>N(l.lead)),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded text-xs"}," 📞 Call Again ")):u("",!0),x(l.lead)?(s(),n("button",{key:2,onClick:p=>O(m),class:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-3 rounded text-xs"}," 🗑️ Delete ",8,Je)):u("",!0)])])]))),128))]))])])])]),b.value?(s(),C(P,{key:0,lead:l.lead,statuses:i.statuses,onClose:y},null,8,["lead","statuses"])):u("",!0),r.value?(s(),C(R,{key:1,callDetail:k.value,lead:l.lead,onClose:y},null,8,["callDetail","lead"])):u("",!0),f.value?(s(),C(xe,{key:2,callDetail:k.value,lead:l.lead,onClose:y},null,8,["callDetail","lead"])):u("",!0),c.value?(s(),n("div",Ke,[e("div",Qe,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:y}),e("div",We,[e("div",Xe,[e("div",Ye,[t[18]||(t[18]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-blue-600 dark:text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),e("div",Ze,[e("h3",et," Add Call for: "+a(l.lead.name),1),e("div",tt,[e("p",lt,a(l.lead.company_name)+" • "+a(l.lead.phone)+" • "+a(l.lead.email),1)])])]),e("form",{onSubmit:F(E,["prevent"]),class:"mt-6"},[e("div",at,[d(o).errors.lead_id?(s(),n("div",st,[e("p",rt,"⚠️ "+a(d(o).errors.lead_id),1)])):u("",!0),e("div",null,[t[19]||(t[19]=e("label",{for:"call_followup_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Call Date * ",-1)),D(e("input",{type:"date",id:"call_followup_date","onUpdate:modelValue":t[1]||(t[1]=m=>d(o).call_followup_date=m),class:M(["mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",{"border-red-500":d(o).errors.call_followup_date}]),required:""},null,2),[[$,d(o).call_followup_date]]),d(o).errors.call_followup_date?(s(),n("div",ot,a(d(o).errors.call_followup_date),1)):u("",!0)]),e("div",null,[t[20]||(t[20]=e("label",{for:"call_followup_summary",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Call Summary * ",-1)),D(e("textarea",{id:"call_followup_summary","onUpdate:modelValue":t[2]||(t[2]=m=>d(o).call_followup_summary=m),rows:"4",class:M(["mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",{"border-red-500":d(o).errors.call_followup_summary}]),placeholder:"Enter call details and outcome...",required:""},null,2),[[$,d(o).call_followup_summary]]),d(o).errors.call_followup_summary?(s(),n("div",dt,a(d(o).errors.call_followup_summary),1)):u("",!0)]),e("div",null,[t[21]||(t[21]=e("label",{for:"next_call_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Next Call Date (Optional) ",-1)),D(e("input",{type:"date",id:"next_call_date","onUpdate:modelValue":t[3]||(t[3]=m=>d(o).next_call_date=m),class:"mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"},null,512),[[$,d(o).next_call_date]]),d(o).errors.next_call_date?(s(),n("div",nt,a(d(o).errors.next_call_date),1)):u("",!0)])]),e("div",it,[e("button",{type:"submit",disabled:d(o).processing,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},a(d(o).processing?"Saving...":"Save Call Details"),9,mt),e("button",{type:"button",onClick:y,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-700 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])],32)])])])])):u("",!0)]),_:1})],64))}};export{ft as default};
