import{m as y,u as T,g as n,o as r,a as b,d as o,h as F,w as f,b as e,c as p,i as u,t as a,F as M,p as z,e as I,k as C,n as V,x as D,l as L,f as $,s as U}from"./app-B2Ju-_XS.js";import{_ as q}from"./ModernLayout-CKcIDrzU.js";import{_ as P}from"./CallModal-vw9wKyi0.js";import{_ as H}from"./EditCallModal-ATnTvc02.js";import{_ as G}from"./ViewCallModal-DT1npveA.js";import"./ApplicationLogo-D2VyM9Ip.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"flex justify-between items-center"},K={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-100"},Q={class:"flex space-x-2"},R={class:"py-6"},W={class:"max-w-9xl mx-auto px-4 sm:px-6 lg:px-8"},X={class:"bg-white dark:bg-gray-800 shadow-sm sm:rounded-lg mb-6"},Y={class:"p-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ee={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},te={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},le={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ae={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},se={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},oe={class:"mt-1 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},re={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},de={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ne={class:"mt-1 text-sm text-gray-900 dark:text-gray-100"},ie={class:"bg-white dark:bg-gray-800 shadow-sm sm:rounded-lg"},ue={class:"p-6"},me={key:0,class:"text-center py-8"},ce={key:1,class:"space-y-4"},xe={class:"flex justify-between items-start"},ge={class:"flex-1"},ye={class:"flex items-center space-x-4"},be={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},fe={class:"text-sm text-gray-500 dark:text-gray-400"},ke={class:"text-sm text-gray-600 dark:text-gray-400 mt-2"},_e={key:0,class:"mt-2"},ve={class:"text-sm text-blue-600 dark:text-blue-400"},we={class:"flex space-x-2"},he=["onClick"],pe=["onClick"],Ce=["onClick"],De={key:3,class:"fixed inset-0 z-50 overflow-y-auto"},Se={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Me={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Ve={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Le={class:"sm:flex sm:items-start"},$e={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},je={class:"text-lg leading-6 font-medium text-gray-900 dark:text-gray-100"},Ae={class:"mt-2"},Ee={class:"text-sm text-gray-500 dark:text-gray-400"},Ne={class:"space-y-4"},Be={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-md"},Oe={class:"text-sm text-red-800"},Te={key:0,class:"mt-1 text-sm text-red-600"},Fe={key:0,class:"mt-1 text-sm text-red-600"},ze={key:0,class:"mt-1 text-sm text-red-600"},Ie={class:"mt-6 sm:flex sm:flex-row-reverse"},Ue=["disabled"],Re={__name:"Show",props:{lead:Object,user:Object},setup(l){const m=l,j=(d,t)=>m.user?.is_admin?!0:m.user?.permissions?.[d]?.includes(t)||!1,x=d=>m.user?.is_admin||j("leads","create")?!0:d.assigned_user_id===m.user?.id,k=y(!1),_=y(!1),v=y(!1),w=y(!1),g=y(null),A=d=>{k.value=!0},S=()=>{_.value=!0},c=()=>{k.value=!1,_.value=!1,v.value=!1,w.value=!1,g.value=null},E=d=>{g.value=d,v.value=!0},N=d=>{g.value=d,w.value=!0},s=T({lead_id:m.lead.id,call_followup_date:new Date().toISOString().split("T")[0],call_followup_summary:"",next_call_date:""}),B=()=>{s.post(route("lead-details.store"),{onSuccess:()=>{c(),s.reset(),s.lead_id=m.lead.id,s.call_followup_date=new Date().toISOString().split("T")[0]},onError:d=>{console.error("Call submission errors:",d)}})},O=d=>{confirm(`Are you sure you want to delete this call record from ${new Date(d.call_followup_date).toLocaleDateString()}?`)&&U.delete(route("lead-details.destroy",d.id),{onSuccess:()=>{},onError:t=>{console.error("Delete call detail errors:",t)}})};return(d,t)=>(r(),n(M,null,[b(o(F),{title:`Lead: ${l.lead.name}`},null,8,["title"]),b(q,null,{header:f(()=>[e("div",J,[e("h2",K," Lead Details: "+a(l.lead.name),1),e("div",Q,[x(l.lead)?(r(),n("button",{key:0,onClick:S,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Add Call ")):u("",!0),b(o(L),{href:d.route("leads.edit",l.lead.id),class:"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"},{default:f(()=>[...t[4]||(t[4]=[$(" Edit Lead ",-1)])]),_:1},8,["href"]),b(o(L),{href:d.route("leads.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:f(()=>[...t[5]||(t[5]=[$(" Back to Leads ",-1)])]),_:1},8,["href"])])])]),default:f(()=>[e("div",R,[e("div",W,[e("div",X,[t[15]||(t[15]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Lead Information")],-1)),e("div",Y,[e("div",Z,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),e("p",ee,a(l.lead.name),1)]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Company",-1)),e("p",te,a(l.lead.company_name||"-"),1)]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Phone",-1)),e("p",le,a(l.lead.phone),1)]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email",-1)),e("p",ae,a(l.lead.email),1)]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Service",-1)),e("p",se,a(l.lead.service.name),1)]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Status",-1)),e("span",oe,a(l.lead.status.name),1)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Assigned To",-1)),e("p",re,a(l.lead.assigned_user.name),1)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Created By",-1)),e("p",de,a(l.lead.creator.name),1)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Created At",-1)),e("p",ne,a(new Date(l.lead.created_at).toLocaleString()),1)])])])]),e("div",ie,[t[17]||(t[17]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Call History")],-1)),e("div",ue,[l.lead.lead_details.length===0?(r(),n("div",me,[t[16]||(t[16]=e("p",{class:"text-gray-500 dark:text-gray-400"},"No call history found.",-1)),x(l.lead)?(r(),n("button",{key:0,onClick:S,class:"mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Add First Call ")):u("",!0)])):(r(),n("div",ce,[(r(!0),n(M,null,z(l.lead.lead_details,i=>(r(),n("div",{key:i.id,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-gray-50 dark:bg-gray-900"},[e("div",xe,[e("div",ge,[e("div",ye,[e("h4",be," Call on "+a(new Date(i.call_followup_date).toLocaleDateString()),1),e("span",fe," by "+a(i.creator.name),1)]),e("p",ke,a(i.call_followup_summary),1),i.next_call_date?(r(),n("div",_e,[e("p",ve," Next call scheduled: "+a(new Date(i.next_call_date).toLocaleDateString()),1)])):u("",!0)]),e("div",we,[e("button",{onClick:h=>N(i),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-3 rounded text-xs"}," 👁️ View ",8,he),x(l.lead)?(r(),n("button",{key:0,onClick:h=>E(i),class:"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-3 rounded text-xs"}," ✏️ Edit ",8,pe)):u("",!0),x(l.lead)?(r(),n("button",{key:1,onClick:t[0]||(t[0]=h=>A(l.lead)),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded text-xs"}," 📞 Call Again ")):u("",!0),x(l.lead)?(r(),n("button",{key:2,onClick:h=>O(i),class:"bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-3 rounded text-xs"}," 🗑️ Delete ",8,Ce)):u("",!0)])])]))),128))]))])])])]),k.value?(r(),p(P,{key:0,lead:l.lead,statuses:d.statuses,onClose:c},null,8,["lead","statuses"])):u("",!0),v.value?(r(),p(H,{key:1,callDetail:g.value,lead:l.lead,onClose:c},null,8,["callDetail","lead"])):u("",!0),w.value?(r(),p(G,{key:2,callDetail:g.value,lead:l.lead,onClose:c},null,8,["callDetail","lead"])):u("",!0),_.value?(r(),n("div",De,[e("div",Se,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:c}),e("div",Me,[e("div",Ve,[e("div",Le,[t[18]||(t[18]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-blue-600 dark:text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),e("div",$e,[e("h3",je," Add Call for: "+a(l.lead.name),1),e("div",Ae,[e("p",Ee,a(l.lead.company_name)+" • "+a(l.lead.phone)+" • "+a(l.lead.email),1)])])]),e("form",{onSubmit:I(B,["prevent"]),class:"mt-6"},[e("div",Ne,[o(s).errors.lead_id?(r(),n("div",Be,[e("p",Oe,"⚠️ "+a(o(s).errors.lead_id),1)])):u("",!0),e("div",null,[t[19]||(t[19]=e("label",{for:"call_followup_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Call Date * ",-1)),C(e("input",{type:"date",id:"call_followup_date","onUpdate:modelValue":t[1]||(t[1]=i=>o(s).call_followup_date=i),class:V(["mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",{"border-red-500":o(s).errors.call_followup_date}]),required:""},null,2),[[D,o(s).call_followup_date]]),o(s).errors.call_followup_date?(r(),n("div",Te,a(o(s).errors.call_followup_date),1)):u("",!0)]),e("div",null,[t[20]||(t[20]=e("label",{for:"call_followup_summary",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Call Summary * ",-1)),C(e("textarea",{id:"call_followup_summary","onUpdate:modelValue":t[2]||(t[2]=i=>o(s).call_followup_summary=i),rows:"4",class:V(["mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",{"border-red-500":o(s).errors.call_followup_summary}]),placeholder:"Enter call details and outcome...",required:""},null,2),[[D,o(s).call_followup_summary]]),o(s).errors.call_followup_summary?(r(),n("div",Fe,a(o(s).errors.call_followup_summary),1)):u("",!0)]),e("div",null,[t[21]||(t[21]=e("label",{for:"next_call_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Next Call Date (Optional) ",-1)),C(e("input",{type:"date",id:"next_call_date","onUpdate:modelValue":t[3]||(t[3]=i=>o(s).next_call_date=i),class:"mt-1 block w-full border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"},null,512),[[D,o(s).next_call_date]]),o(s).errors.next_call_date?(r(),n("div",ze,a(o(s).errors.next_call_date),1)):u("",!0)])]),e("div",Ie,[e("button",{type:"submit",disabled:o(s).processing,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},a(o(s).processing?"Saving...":"Save Call Details"),9,Ue),e("button",{type:"button",onClick:c,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-700 text-base font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])],32)])])])])):u("",!0)]),_:1})],64))}};export{Re as default};
