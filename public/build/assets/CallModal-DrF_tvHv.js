import{m as w,u as v,y as p,g as d,o as i,b as e,t as o,e as C,k as b,i as u,s as _,d as r,n as y,F as D,p as S}from"./app-CdFxFndD.js";const V={class:"fixed inset-0 z-50 overflow-y-auto"},j={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},L={class:"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full"},N={class:"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},O={class:"sm:flex sm:items-start mb-6"},T={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},B={class:"text-lg leading-6 font-medium text-gray-900 dark:text-white"},M={class:"mt-2"},z={class:"text-sm text-gray-500 dark:text-gray-400"},E={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},I={class:"space-y-4"},F={class:"text-md font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-600 pb-2"},U={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},$={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},q={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},P={class:"flex justify-end space-x-3 pt-4"},A=["disabled"],H={class:"space-y-4"},G={key:0,class:"space-y-3"},J={class:"flex justify-between items-start mb-2"},K={class:"flex items-center space-x-2"},Q={class:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded"},R={key:0,class:"text-xs font-medium text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-800 px-2 py-1 rounded"},W={class:"text-xs text-gray-500 dark:text-gray-400"},X={class:"text-sm text-gray-700 dark:text-gray-300 mb-2"},Y={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},Z={key:1,class:"text-xs text-green-600 dark:text-green-400 mt-1"},ee={key:2,class:"text-xs text-orange-600 dark:text-orange-400 mt-1"},te={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},ae={__name:"CallModal",props:{lead:Object},emits:["close"],setup(c,{emit:f}){const m=c,g=f,n=w([]),k=async a=>{if(a)try{const l=await fetch(`/api/leads/${a}/call-history-public`);if(l.ok){const s=await l.json();n.value=s.lead_details||[]}else n.value=[]}catch{n.value=[]}},t=v({lead_id:null,call_followup_date:new Date().toISOString().split("T")[0],call_followup_summary:"",next_call_date:""});p(()=>m.lead,a=>{a&&a.id?(t.lead_id=a.id,a.lead_details&&a.lead_details.length>0?n.value=a.lead_details:k(a.id)):n.value=[]},{immediate:!0}),p(()=>m.callDetail,a=>{a&&(t.call_followup_summary=a.call_followup_summary||"",t.next_call_date=a.next_call_date?new Date(a.next_call_date).toISOString().split("T")[0]:"")},{immediate:!0});const h=()=>{t.lead_id&&(m.callDetail?t.patch(route("lead-details.complete",m.callDetail.id),{onSuccess:()=>{g("close"),t.reset(),t.call_followup_date=new Date().toISOString().split("T")[0]},onError:a=>{}}):t.post(route("lead-details.store"),{onSuccess:()=>{g("close"),t.reset(),t.call_followup_date=new Date().toISOString().split("T")[0]},onError:a=>{}}))};return(a,l)=>(i(),d("div",V,[e("div",j,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 dark:bg-gray-900 bg-opacity-75 dark:bg-opacity-75",onClick:l[0]||(l[0]=s=>g("close"))}),e("div",L,[e("div",N,[e("div",O,[l[5]||(l[5]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})])],-1)),e("div",T,[e("h3",B,o(a.callDetail?"Complete Call":"Call Lead")+": "+o(c.lead?.name||"Loading..."),1),e("div",M,[e("p",z,o(c.lead?.company_name||"Loading...")+" • "+o(c.lead?.phone||"Loading...")+" • "+o(c.lead?.email||"Loading..."),1)])])]),e("div",E,[e("div",I,[e("h4",F,o(a.callDetail?"Complete Call Details":"New Call Details"),1),e("form",{onSubmit:C(h,["prevent"]),class:"space-y-4"},[e("div",null,[l[6]||(l[6]=e("label",{for:"call_followup_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Call Date * ",-1)),b(e("input",{type:"date",id:"call_followup_date","onUpdate:modelValue":l[1]||(l[1]=s=>r(t).call_followup_date=s),class:y(["mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-500":r(t).errors.call_followup_date}]),required:""},null,2),[[_,r(t).call_followup_date]]),r(t).errors.call_followup_date?(i(),d("div",U,o(r(t).errors.call_followup_date),1)):u("",!0)]),e("div",null,[l[7]||(l[7]=e("label",{for:"call_followup_summary",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Call Summary * ",-1)),b(e("textarea",{id:"call_followup_summary","onUpdate:modelValue":l[2]||(l[2]=s=>r(t).call_followup_summary=s),rows:"4",class:y(["mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",{"border-red-500":r(t).errors.call_followup_summary}]),placeholder:"Enter call details and outcome...",required:""},null,2),[[_,r(t).call_followup_summary]]),r(t).errors.call_followup_summary?(i(),d("div",$,o(r(t).errors.call_followup_summary),1)):u("",!0)]),e("div",null,[l[8]||(l[8]=e("label",{for:"next_call_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Next Call Date (Optional) ",-1)),b(e("input",{type:"date",id:"next_call_date","onUpdate:modelValue":l[3]||(l[3]=s=>r(t).next_call_date=s),class:"mt-1 block w-full border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[_,r(t).next_call_date]]),r(t).errors.next_call_date?(i(),d("div",q,o(r(t).errors.next_call_date),1)):u("",!0)]),e("div",P,[e("button",{type:"button",onClick:l[4]||(l[4]=s=>g("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," Cancel "),e("button",{type:"submit",disabled:r(t).processing,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},o(r(t).processing?"Saving...":a.callDetail?"Complete Call":"Save Call Details"),9,A)])],32)]),e("div",H,[l[10]||(l[10]=e("h4",{class:"text-md font-medium text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-600 pb-2"}," Latest Call History ",-1)),n.value&&n.value.length>0?(i(),d("div",G,[(i(!0),d(D,null,S(n.value.slice(0,3),(s,x)=>(i(),d("div",{key:s.id,class:y(["border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",{"bg-blue-50 dark:bg-blue-900 border-blue-200 dark:border-blue-700":x===0}])},[e("div",J,[e("div",K,[e("span",Q," Call #"+o(n.value.length-x),1),x===0?(i(),d("span",R," Latest ")):u("",!0)]),e("span",W,o(new Date(s.call_followup_date).toLocaleDateString()),1)]),e("p",X,o(s.call_followup_summary),1),s.next_call_date?(i(),d("div",Y," Next call: "+o(new Date(s.next_call_date).toLocaleDateString()),1)):u("",!0),s.called_at?(i(),d("div",Z," ✓ Completed on "+o(new Date(s.called_at).toLocaleDateString()),1)):(i(),d("div",ee," ⏳ Pending "))],2))),128))])):(i(),d("div",te,[...l[9]||(l[9]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1),e("p",{class:"mt-2 text-sm"},"No call history available",-1),e("p",{class:"text-xs text-gray-400 dark:text-gray-500"},"This will be the first call for this lead",-1)])]))])])])])])]))}};export{ae as _};
